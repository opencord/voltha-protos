{
  "comments": [
    {
      "unresolved": true,
      "key": {
        "uuid": "5e8f0b55_9a6d560e",
        "filename": "VERSION",
        "patchSetId": 4
      },
      "lineNbr": 1,
      "author": {
        "id": 1000116
      },
      "writtenOn": "2021-12-01T16:52:21Z",
      "side": 1,
      "message": "I\u0027d suggest we go to 5.2.0 given that it\u0027s a new major API.",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e191533c_9d9edec1",
        "filename": "protos/voltha_protos/inter_adapter.proto",
        "patchSetId": 4
      },
      "lineNbr": 26,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2021-12-01T14:20:58Z",
      "side": 1,
      "message": "Why not just have something \"repeated OmciMessage messages\" within the OmciMessages?",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "bfa2a4be_d5755c37",
        "filename": "protos/voltha_protos/inter_adapter.proto",
        "patchSetId": 4
      },
      "lineNbr": 26,
      "author": {
        "id": 1000097
      },
      "writtenOn": "2021-12-01T16:17:31Z",
      "side": 1,
      "message": "Each OmciMessage has the parent/child device details etc which we don\u0027t need to repeat as the messages are destined to the same onu. Only the omci bytes need to be repeated",
      "parentUuid": "e191533c_9d9edec1",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4da04432_9aee36a0",
        "filename": "protos/voltha_protos/inter_adapter.proto",
        "patchSetId": 4
      },
      "lineNbr": 26,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2021-12-02T13:39:10Z",
      "side": 1,
      "message": "ok.  It would have been nice if we had an omicheader message. Not sure if you want to introduce that.",
      "parentUuid": "bfa2a4be_d5755c37",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "8678908f_4acf690b",
        "filename": "protos/voltha_protos/inter_adapter.proto",
        "patchSetId": 4
      },
      "lineNbr": 26,
      "author": {
        "id": 1000097
      },
      "writtenOn": "2021-12-02T13:44:47Z",
      "side": 1,
      "message": "I think we would leave the separation of the header for later. If w separate it out the existing code would need to undergo changes and we wanted to avoid changing the existing code as much as possible.",
      "parentUuid": "4da04432_9aee36a0",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "4c131c64_f59f15d3",
        "filename": "protos/voltha_protos/olt_inter_adapter_service.proto",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2021-12-01T14:20:58Z",
      "side": 1,
      "message": "I was under the impression after the TST meeting where we discuss this approach that we will be using a streaming grpc for this?",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "7267ecde_a4a344af",
        "filename": "protos/voltha_protos/olt_inter_adapter_service.proto",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 1000097
      },
      "writtenOn": "2021-12-01T16:17:31Z",
      "side": 1,
      "message": "Hi Khen, yes you are correct that we discussed that we would use grpc streaming. \n\nBut when we came back and looked into the problem/use case here, it\u0027s better to use unary than streaming. The ONU adapter has a bunch of messages (32 in this case) to send and only after those 32 are sent out and a response comes back from the ONU, it can send the next bunch of 32 messages. So streaming does not really help as it\u0027s like one big message that needs to be sent out and the next big one.\n\nWe actually did try out streaming as well just to see how it performs and we see that the performance of unary is much better when using the bunched up messages. Logically if we stream each individual message over the stream the performance would be even lower as it incurs many more writes of smaller packets on the TCP connection.\n\nIf we have all the data that can be sent to the other end, then why stream it and not send it over a unary grpc.",
      "parentUuid": "4c131c64_f59f15d3",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "02dece09_478ade96",
        "filename": "protos/voltha_protos/olt_inter_adapter_service.proto",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 1000116
      },
      "writtenOn": "2021-12-01T16:52:21Z",
      "side": 1,
      "message": "thanks for the detailed points Amit, I\u0027d be ok with the change as it is given your description.",
      "parentUuid": "7267ecde_a4a344af",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "2ffabc67_a8178e2e",
        "filename": "protos/voltha_protos/olt_inter_adapter_service.proto",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2021-12-02T13:39:10Z",
      "side": 1,
      "message": "For sure unary is much simpler and no change is needed in the existing grpc code base, other than adding this new API.  \n\nDoes the OLT send the block of OMCI message it received to the OLT Agent in one big chunk or it is sending one message as a time?   And if there is an error returned for any of these message does the whole set of OMCI message get reverted back or a retry of the whole set of messages is done by the ONU adapter?   I am trying to understand the overall performance gain by sending an OMCI block.",
      "parentUuid": "02dece09_478ade96",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "68d1ed64_5c6f6e66",
        "filename": "protos/voltha_protos/olt_inter_adapter_service.proto",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 1000097
      },
      "writtenOn": "2021-12-02T13:44:47Z",
      "side": 1,
      "message": "We have not done the optimization of the OLT adapter sending this bunch of messages as a single block to the agent. This can be done later. The OLT adapter still sends the messages as earlier, ie. one at a time to the agent. If there are any errors; the ONU will respond back with an error in the OMCI response and in that the entire bunch should be resent by the ONU adapter (this is as per the OMCI protocol)",
      "parentUuid": "2ffabc67_a8178e2e",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "6d067827_5ab2cda3",
        "filename": "protos/voltha_protos/olt_inter_adapter_service.proto",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2021-12-02T14:19:13Z",
      "side": 1,
      "message": "The error scenario is a tricky one.   Let\u0027s assume the 32nd omcimessage keeps producing an error, then the entire 32 omcimessages will be resent to the olt adapter where they get dispatch one at a time until we get the error on the 32nd one and repeat the entire process.   \n\nI suggest getting the changes in the onu and olt adapters done and then test everything together (especially restart scenarios and some scale tests) before merging all of them together.   This way we will know if there is any tweak needed in the protos and the performance gain in our test scenarios - the error snenario I mentioned above may be a moot point if we do not see that happening in our tests.",
      "parentUuid": "68d1ed64_5c6f6e66",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "c30fb98a_65ab1b82",
        "filename": "protos/voltha_protos/olt_inter_adapter_service.proto",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 1000097
      },
      "writtenOn": "2021-12-02T14:25:15Z",
      "side": 1,
      "message": "Yes, the changes in the ONU and OLT adapters are done and tested and it\u0027s working fine. We have done scale test of the upgrade on 32 ONUs simultaneously and that\u0027s fine as well.\n\nThose changes also should be up for review, but we need this patchset to be merged and then we can point the OLT and ONU adapter changes to this version of the protos and submit the changes.\n\nCan we get this one merged?",
      "parentUuid": "6d067827_5ab2cda3",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    },
    {
      "unresolved": true,
      "key": {
        "uuid": "e24efd15_0adb6751",
        "filename": "protos/voltha_protos/olt_inter_adapter_service.proto",
        "patchSetId": 4
      },
      "lineNbr": 19,
      "author": {
        "id": 1000056
      },
      "writtenOn": "2021-12-02T14:28:36Z",
      "side": 1,
      "message": "Did you try the onu reconcile tests (onu restart scenarios)?",
      "parentUuid": "c30fb98a_65ab1b82",
      "revId": "c40c3b8b03e6eaa870b888fb8f8862fe56b45767",
      "serverId": "2a2bfe1b-c5c2-48ed-9ac8-16438ab24388"
    }
  ]
}